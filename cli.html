<!DOCTYPE html><html lang="en"><head><title>cli</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content=""><meta name="groc-document-path" content="cli"><meta name="groc-project-path" content="src/cli.ls"><meta name="groc-github-url" content="https://github.com/hychen/addressbook-data-converter"><link rel="stylesheet" type="text/css" media="all" href="assets/style.css"><script type="text/javascript" src="assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/hychen/addressbook-data-converter/blob/master/src/cli.ls">src/cli.ls</a></div></div><div id="document"><div class="segment"><div class="comments "><div class="wrapper"><h1 id="command-line-tool">Command Line Tool</h1></div></div></div><div class="segment"><div class="code"><div class="wrapper"><span class="nx">require</span><span class="o">!</span> <span class="s">&lt;[optimist pgrest]&gt;</span>

<span class="nx">export</span> <span class="nx">function</span> <span class="nx">plx</span><span class="p">(</span><span class="nx">opts</span><span class="o">=</span><span class="p">{</span><span class="o">+</span><span class="nx">client</span><span class="p">},</span> <span class="nx">cb</span><span class="p">)</span>
  <span class="nv">conString = </span><span class="nx">optimist</span><span class="p">.</span><span class="nx">argv</span><span class="p">.</span><span class="nx">db</span> <span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">PGDATABASE</span>
  <span class="nv">conString = </span><span class="s">&quot;localhost/#conString&quot;</span> <span class="k">unless</span> <span class="nx">conString</span> <span class="o">is</span> <span class="sr">//</span> <span class="sr">/</span> <span class="sr">//</span>
  <span class="nv">conString = </span><span class="s">&quot;tcp://#conString&quot;</span>     <span class="k">unless</span> <span class="nx">conString</span> <span class="o">is</span> <span class="sr">//</span> <span class="sr">:/</span> <span class="sr">//</span>

  <span class="nx">pgrest</span> <span class="p">.</span><span class="nx">new</span> <span class="nx">conString</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">cb</span>

<span class="nx">export</span> <span class="nx">function</span> <span class="nx">shellrun</span><span class="p">(</span><span class="nx">cmd</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">cb</span><span class="p">)</span>
  <span class="nx">require</span><span class="o">!</span> <span class="nx">shelljs</span>
  <span class="nv">c = </span><span class="nx">shelljs</span><span class="p">.</span><span class="nx">exec</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">opts</span><span class="p">,</span> <span class="nx">cb</span>
  <span class="nx">c</span><span class="p">.</span><span class="nx">stderr</span><span class="p">.</span><span class="nx">on</span> <span class="s">&#39;data&#39;</span> <span class="nf">-&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span> <span class="nx">it</span></div></div></div></div></body></html>